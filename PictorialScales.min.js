function Arrow(t,i,o){var e=this;this.canvas=document.getElementById(t),this.element=document.getElementById(i),this.fuzzy={},this.defaultConfiguration={fuzzyPartition:[{bounds:[0,0,15,50],color:[255,0,0],label:"U"},{bounds:[15,50,55,90],color:[255,255,0],label:"N"},{bounds:[55,90,100,100],color:[0,255,0],label:"S"}],colorPrototypes:[{label:"U",prototype:[255,0,0]},{label:"N",prototype:[255,255,0]},{label:"S",prototype:[0,255,0]}],anglePrototypes:[{label:"U",prototype:-40},{label:"N",prototype:0},{label:"S",prototype:40}],options:{arrowThickness:12,arrowLength:95,canvasFuzzyHeight:150,canvasFuzzyWidth:400}},this.initialize=function(t){return new Configuration(this,t).configuration},this.configuration=this.initialize(o),this.render=function(){this.canvas.getContext&&this.draw(this.element.value),null!==this.fuzzy.canvasFuzzy&&this.fuzzy.drawFuzzyPartition()},this.doubleClickEventManager=function(){null===e.fuzzy.canvasFuzzy?e.fuzzy.drawFuzzyPartition():(e.canvas.parentNode.removeChild(e.fuzzy.canvasFuzzy),e.fuzzy.canvasFuzzy=null)},this.draw=function(t){var i,o=this.canvas.width,e=this.canvas.getContext("2d");this.fuzzy=new Fuzzy(this),this.fuzzy.fuzzyInput=t;var n=this.fuzzy.fuzzyDescription(t,this.configuration.fuzzyPartition);i=this.fuzzy.defuzzify(n,this.configuration.colorPrototypes),angle=this.fuzzy.defuzzify(n,this.configuration.anglePrototypes),e.clearRect(0,0,o,o);var a=this.configuration.options.arrowLength,s=this.configuration.options.arrowThickness,r=s,h=o/2,u=-angle*Math.PI/180;e.beginPath(),e.save(),e.rotate(u),e.translate(h*Math.sin(u)+r*Math.cos(u),h*Math.cos(u)-r*Math.sin(u)-o/2),e.fillStyle="rgb("+Math.round(i[0])+","+Math.round(i[1])+","+Math.round(i[2])+")",e.moveTo(r,h),e.lineTo(r,h-this.configuration.options.arrowThickness),e.lineTo(r+a-2*s,o/2-s),e.lineTo(r+a-2*s,o/2-2*s),e.lineTo(r+a,o/2),e.lineTo(r+a-2*s,o/2+2*s),e.lineTo(r+a-2*s,o/2+s),e.lineTo(r,o/2+s),e.closePath(),e.fill(),e.restore(),e.stroke()}}function SunCloud(t,i,o){var e=this;this.canvas=document.getElementById(t),this.element=document.getElementById(i),this.fuzzy={},this.defaultConfiguration={fuzzyPartition:[{bounds:[0,0,0,25],color:[255,0,0],label:"VL"},{bounds:[0,25,25,50],color:[255,128,0],label:"L"},{bounds:[25,50,50,75],color:[255,255,0],label:"N"},{bounds:[50,75,75,100],color:[128,255,0],label:"R"},{bounds:[75,100,100,100],color:[0,255,0],label:"VR"}],sunSizePrototypes:[{label:"VL",prototype:0},{label:"L",prototype:0},{label:"N",prototype:30},{label:"R",prototype:35},{label:"VR",prototype:40}],sunPositionPrototypes:[{label:"VL",prototype:[0,0]},{label:"L",prototype:[0,0]},{label:"N",prototype:[0,0]},{label:"R",prototype:[0,0]},{label:"VR",prototype:[0,0]}],sunColorPrototypes:[{label:"VL",prototype:[255,255,255]},{label:"L",prototype:[255,128,0]},{label:"N",prototype:[204,204,0]},{label:"R",prototype:[230,230,0]},{label:"VR",prototype:[255,255,0]}],sunraySizePrototypes:[{label:"VL",prototype:0},{label:"L",prototype:0},{label:"N",prototype:.8},{label:"R",prototype:1},{label:"VR",prototype:1.3}],cloudSizePrototypes:[{label:"VL",prototype:1.3},{label:"L",prototype:1},{label:"N",prototype:.8},{label:"R",prototype:0},{label:"VR",prototype:0}],cloudPositionPrototypes:[{label:"VL",prototype:[-50,0]},{label:"L",prototype:[-15,0]},{label:"N",prototype:[0,0]},{label:"R",prototype:[5,0]},{label:"VR",prototype:[5,0]}],cloudColorPrototypes:[{label:"VL",prototype:[25,25,25]},{label:"L",prototype:[127,127,127]},{label:"N",prototype:[192,192,192]},{label:"R",prototype:[255,255,255]},{label:"VR",prototype:[255,255,255]}],rainLevelPrototypes:[{label:"VL",prototype:10},{label:"L",prototype:7},{label:"N",prototype:0},{label:"R",prototype:0},{label:"VR",prototype:0}],options:{}},this.initialize=function(t){return new Configuration(this,t).configuration},this.configuration=this.initialize(o),this.render=function(){this.canvas.getContext&&this.draw(this.element.value),null!==this.fuzzy.canvasFuzzy&&this.fuzzy.drawFuzzyPartition()},this.doubleClickEventManager=function(){null===e.fuzzy.canvasFuzzy?e.fuzzy.drawFuzzyPartition():(e.canvas.parentNode.removeChild(e.fuzzy.canvasFuzzy),e.fuzzy.canvasFuzzy=null)},this.draw=function(t){var i=this.canvas.width,o=this.canvas.getContext("2d");this.fuzzy=new Fuzzy(this),this.fuzzy.fuzzyInput=t;var e=this.fuzzy.fuzzyDescription(t,this.configuration.fuzzyPartition),n=this.fuzzy.defuzzify(e,this.configuration.sunSizePrototypes),a=this.fuzzy.defuzzify(e,this.configuration.sunPositionPrototypes),s=this.fuzzy.defuzzify(e,this.configuration.sunColorPrototypes),r=this.fuzzy.defuzzify(e,this.configuration.sunraySizePrototypes),h=this.fuzzy.defuzzify(e,this.configuration.cloudSizePrototypes),u=this.fuzzy.defuzzify(e,this.configuration.cloudPositionPrototypes),l=this.fuzzy.defuzzify(e,this.configuration.cloudColorPrototypes),z=this.fuzzy.defuzzify(e,this.configuration.rainLevelPrototypes);if(o.clearRect(0,0,i,i),0<n){o.save(),o.beginPath(),o.strokeStyle="rgb("+Math.round(s[0])+","+Math.round(s[1])+","+Math.round(s[2])+")";for(var c=0;c<12;c++)o.moveTo(a[0]+i/2+n*Math.cos(c*Math.PI/6),a[1]+i/2+n*Math.sin(c*Math.PI/6)),o.lineTo(a[0]+i/2+n*(1+r)*Math.cos(c*Math.PI/6),a[1]+i/2+n*(1+r)*Math.sin(c*Math.PI/6)),o.stroke();o.closePath(),o.restore(),o.beginPath(),o.fillStyle="rgb("+Math.round(s[0])+","+Math.round(s[1])+","+Math.round(s[2])+")",o.arc(a[0]+i/2,a[1]+i/2,n,0,2*Math.PI,!0),o.fill(),o.stroke(),o.closePath()}if(0<h){var f=[u[0]+i/2,u[1]+i/2,10*h],d=[f[0]+20*h,f[1]-8*h,20*h],y=[d[0]+24*h,f[1]-12*h,30*h],p=[y[0]+24*h,f[1]-6*h,16*h],g=this.circleIntersection(f,d,-1),b=this.circleIntersection(d,y,-1),m=this.circleIntersection(y,p,1);o.save(),o.fillStyle="rgb("+Math.round(l[0])+","+Math.round(l[1])+","+Math.round(l[2])+")",o.beginPath(),o.arc(f[0],f[1],f[2],Math.PI/2,3*Math.PI/2,!1);var v=Math.atan2(g[1]-d[1],g[0]-d[0]),P=Math.atan2(b[1]-d[1],b[0]-d[0]);o.arc(d[0],d[1],d[2],v,P,!1);v=Math.atan2(b[1]-y[1],b[0]-y[0]),P=Math.atan2(m[1]-y[1],m[0]-y[0]);o.arc(y[0],y[1],y[2],v,P,!1);v=Math.atan2(m[1]-p[1],m[0]-p[0]),P=Math.PI/2;if(o.arc(p[0],p[1],p[2],v,P,!1),o.closePath(),o.fill(),o.stroke(),o.restore(),1<z){o.save(),o.strokeStyle="rgb("+Math.round(l[0])+","+Math.round(l[1])+","+Math.round(l[2])+")";var T=Math.round((p[0]-f[0])/(z-1));for(c=0;c<Math.round(z);c++)o.moveTo(f[0]+T*c,f[1]+f[2]),o.lineTo(f[0]+T*c+5*h,f[1]+f[2]+5*h),o.stroke();o.restore()}}},this.circleIntersection=function(t,i,o){var e=(i[0]-t[0])/(i[1]-t[1]),n=(t[2]*t[2]-i[2]*i[2]-t[0]*t[0]+i[0]*i[0]-t[1]*t[1]+i[1]*i[1])/(2*(i[1]-t[1])),a=e*e+1,s=2*i[1]*e-2*n*e-2*i[0],r=i[0]*i[0]+i[1]*i[1]+n*n-i[2]*i[2]-2*i[1]*n,h=(o*Math.sqrt(s*s-4*a*r)-s)/(2*a);return[h,n-h*e]}}function Emoticon(t,i,o){var e=this;this.canvas=document.getElementById(t),this.element=document.getElementById(i),this.fuzzy={},this.defaultConfiguration={fuzzyPartition:[{bounds:[0,0,15,50],color:[255,0,0],label:"U"},{bounds:[15,50,55,90],color:[255,255,0],label:"N"},{bounds:[55,90,100,100],color:[0,255,0],label:"S"}],colorPrototypes:[{label:"U",prototype:[255,0,0]},{label:"N",prototype:[255,255,0]},{label:"S",prototype:[0,255,0]}],smilePrototypes:[{label:"U",prototype:-.5},{label:"N",prototype:0},{label:"S",prototype:1}],eyesSizePrototypes:[{label:"U",prototype:1},{label:"N",prototype:1},{label:"S",prototype:1}],options:{eyeWidthToSizeRatio:.08,eyeHeightToWidthRatio:1.5,eyeXPositionToSizeRatio:.2,eyeYPositionToSizeRatio:.1,mouthLengthToSizeRatio:.55,mouthYPositionToSizeRatio:.2,smileToSizeRatio:.3,canvasFuzzyHeight:150,canvasFuzzyWidth:400}},this.initialize=function(t){return new Configuration(this,t).configuration},this.configuration=this.initialize(o),this.render=function(){this.canvas.getContext&&this.draw(this.element.value),null!==this.fuzzy.canvasFuzzy&&this.fuzzy.drawFuzzyPartition()},this.doubleClickEventManager=function(){null===e.fuzzy.canvasFuzzy?e.fuzzy.drawFuzzyPartition():(e.canvas.parentNode.removeChild(e.fuzzy.canvasFuzzy),e.fuzzy.canvasFuzzy=null)},this.draw=function(t){var i,o,e=this.canvas.width,n=this.canvas.getContext("2d");this.fuzzy=new Fuzzy(this),this.fuzzy.fuzzyInput=t;var a=this.fuzzy.fuzzyDescription(t,this.configuration.fuzzyPartition);i=this.fuzzy.defuzzify(a,this.configuration.colorPrototypes),o=this.fuzzy.defuzzify(a,this.configuration.smilePrototypes),eyesSize=this.fuzzy.defuzzify(a,this.configuration.eyesSizePrototypes),n.beginPath(),n.fillStyle="rgb("+Math.round(i[0])+","+Math.round(i[1])+","+Math.round(i[2])+")",n.arc(e/2,e/2,e/2,0,2*Math.PI,!0),n.fill(),n.closePath(),n.beginPath(),n.moveTo(e*(1-this.configuration.options.mouthLengthToSizeRatio)/2,e*(.5+this.configuration.options.mouthYPositionToSizeRatio)),n.closePath(),n.quadraticCurveTo(e/2,e*(.5+this.configuration.options.mouthYPositionToSizeRatio+this.configuration.options.smileToSizeRatio*o),e*(1+this.configuration.options.mouthLengthToSizeRatio)/2,e*(.5+this.configuration.options.mouthYPositionToSizeRatio)),n.stroke(),n.fillStyle="black",n.beginPath(),n.moveTo(e/2-this.configuration.options.eyeXPositionToSizeRatio*e,e/2-this.configuration.options.eyeYPositionToSizeRatio*e),n.closePath(),n.save(),n.scale(1,eyesSize*this.configuration.options.eyeHeightToWidthRatio),n.arc(e/2-this.configuration.options.eyeXPositionToSizeRatio*e,(e/2-this.configuration.options.eyeYPositionToSizeRatio*e)/(eyesSize*this.configuration.options.eyeHeightToWidthRatio),this.configuration.options.eyeWidthToSizeRatio*e,0,2*Math.PI,!0),n.fill(),n.restore(),n.beginPath(),n.moveTo(e/2+this.configuration.options.eyeXPositionToSizeRatio*e,e/2-this.configuration.options.eyeYPositionToSizeRatio*e),n.closePath(),n.save(),n.scale(1,eyesSize*this.configuration.options.eyeHeightToWidthRatio),n.arc(e/2+this.configuration.options.eyeXPositionToSizeRatio*e,(e/2-this.configuration.options.eyeYPositionToSizeRatio*e)/(eyesSize*this.configuration.options.eyeHeightToWidthRatio),this.configuration.options.eyeWidthToSizeRatio*e,0,2*Math.PI,!0),n.fill(),n.restore(),n.stroke()}}function BiEmoticon(t,i,o){var a=this;this.canvas=document.getElementById(t),this.element=document.getElementById(i),this.fuzzy={},this.defaultConfiguration={fuzzyPartition:[{bounds:[0,0,15,50],color:[255,0,0],label:"U"},{bounds:[15,50,55,90],color:[255,255,0],label:"N"},{bounds:[55,90,100,100],color:[0,255,0],label:"S"}],colorPrototypes:[{label:"U",prototype:[255,0,0]},{label:"N",prototype:[255,255,0]},{label:"S",prototype:[0,255,0]}],smilePrototypes:[{label:"U",prototype:-.5},{label:"N",prototype:0},{label:"S",prototype:1}],options:{eyeWidthToSizeRatio:.08,eyeHeightToWidthRatio:1.5,eyeXPositionToSizeRatio:.2,eyeYPositionToSizeRatio:.1,mouthLengthToSizeRatio:.55,mouthYPositionToSizeRatio:.2,smileToSizeRatio:.2,sliderThumbWidth:10,canvasFuzzyHeight:150,canvasFuzzyWidth:400}},this.sliderThumbWidth=0,this.leftStartAngle=0,this.leftEndAngle=2*Math.PI,this.rightStartAngle=Math.PI/2,this.rightEndAngle=-Math.PI/2,this.dashSize=3,this.rightButtonDown=!1,this.initialize=function(t){var i=new Configuration(this,t);return this.sliderThumbWidth=i.configuration.options.sliderThumbWidth,document.getElementById("slidersStyle").innerHTML="."+this.element.id+"::-moz-range-thumb {width: "+this.sliderThumbWidth+"%;}",document.getElementById("slidersStyle").innerHTML+="."+this.element.id+"::-webkit-slider-thumb {width: "+this.sliderThumbWidth+"%;}",document.getElementById("slidersStyle").innerHTML+="."+this.element.id+"::-ms-thumb {width: "+Math.round(this.sliderThumbWidth*this.element.offsetWidth/100)+"px;}",this.element.classList.add(this.element.id),this.element.addEventListener?(this.element.addEventListener("mousewheel",function(t){a.wheelEventManager(t)},!1),this.element.addEventListener("wheel",function(t){a.wheelEventManager(t)},!1)):this.element.attachEvent("onmousewheel",function(t){a.wheelEventManager(t)}),this.element.addEventListener("mousedown",function(t){a.rightButtonDown=!0}),this.element.addEventListener("mouseup",function(t){a.rightButtonDown=!1}),this.canvas.addEventListener("click",function(){a.clickEventManager(event)},!1),i.configuration},this.configuration=this.initialize(o),this.render=function(){if(this.canvas.getContext){var t=(100-this.sliderThumbWidth)*this.element.value/100+this.sliderThumbWidth/2;this.draw([t-this.sliderThumbWidth/2,t,t,t+this.sliderThumbWidth/2])}null!==this.fuzzy.canvasFuzzy&&this.fuzzy.drawFuzzyPartition()},this.wheelEventManager=function(t){if(t.preventDefault(),!0===this.rightButtonDown){var i=document.getElementById("slidersStyle");0<t.deltaY?parseInt(this.element.value)<100-this.sliderThumbWidth/2&&(this.element.value=parseInt(this.element.value)+1,1<this.sliderThumbWidth&&(this.sliderThumbWidth-=1)):(this.element.value=parseInt(this.element.value)-1,this.sliderThumbWidth<100&&(this.sliderThumbWidth+=1)),i.innerHTML="."+this.element.id+"::-moz-range-thumb {width: "+a.sliderThumbWidth+"%;}",i.innerHTML+="."+this.element.id+"::-webkit-slider-thumb {width: "+a.sliderThumbWidth+"%;}",i.innerHTML+="."+this.element.id+"::-ms-thumb {width: "+this.sliderThumbWidth*this.element.offsetWidth/100+"px;}"}this.render()},this.doubleClickEventManager=function(){null===a.fuzzy.canvasFuzzy?a.fuzzy.drawFuzzyPartition():(a.canvas.parentNode.removeChild(a.fuzzy.canvasFuzzy),a.fuzzy.canvasFuzzy=null)},this.clickEventManager=function(t){var i=window.scrollY;void 0===i&&(i=document.documentElement.scrollTop);var o=t.pageX-a.canvas.getBoundingClientRect().left,e=t.pageY-a.canvas.getBoundingClientRect().top-i,n=this.canvas.width;(o-n/2)*(o-n/2)+(n/2-e)*(n/2-e)<n*n/4?(this.leftStartAngle=0,this.leftEndAngle=2*Math.PI,this.rightStartAngle=Math.PI/2,this.rightEndAngle=-Math.PI/2,this.dashSize=3):(o<n/2?(this.leftStartAngle=0,this.leftEndAngle=2*Math.PI,this.rightStartAngle=0,this.rightEndAngle=0):(this.leftStartAngle=0,this.leftEndAngle=0,this.rightStartAngle=0,this.rightEndAngle=2*Math.PI),this.dashSize=0),a.render()},this.draw=function(t){var i,o,e,n,a=this.canvas.width,s=this.canvas.getContext("2d");this.fuzzy=new Fuzzy(this),this.fuzzy.fuzzyInput=t;for(var r=this.fuzzy.fuzzyLowerDescription(t,this.configuration.fuzzyPartition),h=0,u=0;u<r.length;u++)h=Math.max(h,r[u].value);var l=[t[1]-this.sliderThumbWidth*(1-h)/2,t[1]+this.sliderThumbWidth*(1-h)/2];r=this.fuzzy.fuzzyDescription(l[0],this.configuration.fuzzyPartition),i=this.fuzzy.defuzzify(r,this.configuration.colorPrototypes),e=this.fuzzy.defuzzify(r,this.configuration.smilePrototypes),r=this.fuzzy.fuzzyDescription(l[1],this.configuration.fuzzyPartition),o=this.fuzzy.defuzzify(r,this.configuration.colorPrototypes),n=this.fuzzy.defuzzify(r,this.configuration.smilePrototypes),s.beginPath(),s.fillStyle="rgb("+Math.round(i[0])+","+Math.round(i[1])+","+Math.round(i[2])+")",s.arc(a/2,a/2,a/2,this.leftStartAngle,this.leftEndAngle,!1),s.fill(),s.closePath(),s.beginPath(),s.fillStyle="rgb("+Math.round(o[0])+","+Math.round(o[1])+","+Math.round(o[2])+")",s.arc(a/2,a/2,a/2,this.rightStartAngle,this.rightEndAngle,!0),s.fill(),s.closePath(),0!=this.leftEndAngle&&(s.beginPath(),s.moveTo(a*(1-this.configuration.options.mouthLengthToSizeRatio)/2,a*(.5+this.configuration.options.mouthYPositionToSizeRatio)),s.closePath(),s.quadraticCurveTo(a*(1.2-this.configuration.options.mouthLengthToSizeRatio)/2,a*(.5+this.configuration.options.mouthYPositionToSizeRatio+this.configuration.options.smileToSizeRatio*e),a/2,a*(.5+this.configuration.options.mouthYPositionToSizeRatio+this.configuration.options.smileToSizeRatio*e)),s.stroke(),s.beginPath(),s.moveTo(a/2,a*(.5+this.configuration.options.mouthYPositionToSizeRatio+this.configuration.options.smileToSizeRatio*e)),s.closePath(),s.save(),s.setLineDash([this.dashSize,this.dashSize]),s.quadraticCurveTo(a*(.8+this.configuration.options.mouthLengthToSizeRatio)/2,a*(.5+this.configuration.options.mouthYPositionToSizeRatio+this.configuration.options.smileToSizeRatio*e),a*(1+this.configuration.options.mouthLengthToSizeRatio)/2,a*(.5+this.configuration.options.mouthYPositionToSizeRatio)),s.stroke()),0!=this.rightEndAngle&&(s.beginPath(),s.moveTo(a*(1-this.configuration.options.mouthLengthToSizeRatio)/2,a*(.5+this.configuration.options.mouthYPositionToSizeRatio)),s.closePath(),s.quadraticCurveTo(a*(1.2-this.configuration.options.mouthLengthToSizeRatio)/2,a*(.5+this.configuration.options.mouthYPositionToSizeRatio+this.configuration.options.smileToSizeRatio*n),a/2,a*(.5+this.configuration.options.mouthYPositionToSizeRatio+this.configuration.options.smileToSizeRatio*n)),s.stroke(),s.restore(),s.beginPath(),s.moveTo(a/2,a*(.5+this.configuration.options.mouthYPositionToSizeRatio+this.configuration.options.smileToSizeRatio*n)),s.closePath(),s.quadraticCurveTo(a*(.8+this.configuration.options.mouthLengthToSizeRatio)/2,a*(.5+this.configuration.options.mouthYPositionToSizeRatio+this.configuration.options.smileToSizeRatio*n),a*(1+this.configuration.options.mouthLengthToSizeRatio)/2,a*(.5+this.configuration.options.mouthYPositionToSizeRatio)),s.stroke()),s.fillStyle="black",s.beginPath(),s.moveTo(a/2-this.configuration.options.eyeXPositionToSizeRatio*a,a/2-this.configuration.options.eyeYPositionToSizeRatio*a),s.closePath(),s.save(),s.scale(1,this.configuration.options.eyeHeightToWidthRatio),s.arc(a/2-this.configuration.options.eyeXPositionToSizeRatio*a,(a/2-this.configuration.options.eyeYPositionToSizeRatio*a)/this.configuration.options.eyeHeightToWidthRatio,this.configuration.options.eyeWidthToSizeRatio*a,0,2*Math.PI,!0),s.fill(),s.restore(),s.beginPath(),s.moveTo(a/2+this.configuration.options.eyeXPositionToSizeRatio*a,a/2-this.configuration.options.eyeYPositionToSizeRatio*a),s.closePath(),s.save(),s.scale(1,this.configuration.options.eyeHeightToWidthRatio),s.arc(a/2+this.configuration.options.eyeXPositionToSizeRatio*a,(a/2-this.configuration.options.eyeYPositionToSizeRatio*a)/this.configuration.options.eyeHeightToWidthRatio,this.configuration.options.eyeWidthToSizeRatio*a,0,2*Math.PI,!0),s.fill(),s.restore(),s.stroke()}}function Configuration(t,i){this.parentObject=t,this.configuration={};var o=this;this.empty=function(t){if("number"==typeof t||"boolean"==typeof t)return!1;if(null==t)return!0;if(void 0!==t.length)return 0==t.length;var i=0;for(var o in t)t.hasOwnProperty(o)&&i++;return 0==i},this.addEventlisteners=function(){window.addEventListener("load",function(){o.parentObject.render()},!0),this.parentObject.element.addEventListener("input",function(){o.parentObject.render()},!1),this.parentObject.element.addEventListener("change",function(){o.parentObject.render()},!0),this.parentObject.canvas.addEventListener("dblclick",function(){o.parentObject.doubleClickEventManager()},!1)},this.update=function(t){this.empty(t)?this.configuration=this.parentObject.defaultConfiguration:(this.configuration=Object.assign({},this.parentObject.defaultConfiguration,t),this.configuration.options=Object.assign({},this.parentObject.defaultConfiguration.options,t.options))},this.polyfills=function(){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,i){"use strict";if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(t),e=1;e<arguments.length;e++){var n=arguments[e];if(null!=n)for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(o[a]=n[a])}return o},writable:!0,configurable:!0}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),o=i.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e=arguments[1],n=0;n<o;){var a=i[n];if(t.call(e,a,n,i))return n;n++}return-1},configurable:!0,writable:!0})},this.initialize=function(t){this.addEventlisteners(),this.update(t),this.polyfills()},this.initialize(i)}function Fuzzy(t){this.parentObject=t,this.canvasFuzzy=document.getElementById(t.canvas.id+"Fuzzy"),this.fuzzyInput=null,this.drawFuzzyPartition=function(){var t=this.parentObject.configuration.fuzzyPartition;null===this.canvasFuzzy&&(this.canvasFuzzy=document.createElement("canvas"),this.canvasFuzzy.id=this.parentObject.canvas.id+"Fuzzy","range"==this.parentObject.element.type?this.canvasFuzzy.width=this.parentObject.element.offsetWidth:this.canvasFuzzy.width=this.parentObject.configuration.options.canvasFuzzyWidth,this.canvasFuzzy.height=this.parentObject.configuration.options.canvasFuzzyHeight,this.canvasFuzzy.classList.add("fuzzy"),this.parentObject.canvas.parentNode.insertBefore(this.canvasFuzzy,this.parentObject.canvas.nextSibling));for(var i=t[0].bounds[0],o=t[0].bounds[3],e=1;e<t.length;e++)t[e].bounds[0]<i&&(i=t[e].bounds[0]),t[e].bounds[3]>o&&(o=t[e].bounds[3]);var n=this.canvasFuzzy.getContext("2d"),a=this.canvasFuzzy.width/(o-i);if(this.canvasFuzzy.getContext){n.clearRect(0,0,this.canvasFuzzy.width,this.canvasFuzzy.height);for(e=0;e<t.length;e++)n.save(),n.beginPath(),n.strokeStyle="rgb("+t[e].color[0]+","+t[e].color[1]+","+t[e].color[2]+")",n.moveTo(a*(t[e].bounds[0]-i),140),n.lineTo(a*(t[e].bounds[1]-i),10),n.lineTo(a*(t[e].bounds[2]-i),10),n.lineTo(a*(t[e].bounds[3]-i),140),n.closePath(),n.stroke(),n.restore();null!==this.fuzzyInput&&(n.save(),n.beginPath(),n.setLineDash([3,3]),Array.isArray(this.fuzzyInput)?(n.moveTo(a*(this.fuzzyInput[0]-i),140),n.lineTo(a*(this.fuzzyInput[1]-i),10),n.lineTo(a*(this.fuzzyInput[3]-i),140)):(n.moveTo(a*(this.fuzzyInput-i),140),n.lineTo(a*(this.fuzzyInput-i),10)),n.stroke(),n.restore())}},this.fuzzyDescription=function(t,o){var e=[];for(i=0;i<o.length;i++)e[i]={value:this.gradeOfMembership(o[i],t),label:o[i].label};return e},this.fuzzyLowerDescription=function(t,o){var e=[];for(i=0;i<o.length;i++)e[i]={value:this.gradeOfMembershipTrapezoidalInput(o[i],t),label:o[i].label};return e},this.gradeOfMembershipTrapezoidalInput=function(t,i){var o,e=i[0],n=i[1],a=i[2],s=i[3],r=1;if(g2=t.bounds[0],mg2=t.bounds[1],md2=t.bounds[2],d2=t.bounds[3],e==n&&e==a&&e==s)return this.gradeOfMembership(t,e);r=1;if(n>d2||a<g2)return 0;if(mg2<=e&&s<=md2)return 1;if(mg2==g2?e<=mg2&&mg2<=n&&(r=Math.min(r,(g2-n)/(n-e))):(o=n==e?e:((mg2-g2)*n+(n-e)*g2)/(mg2-g2+(n-e)),g2<=o&&o<=mg2&&(r=Math.min(r,(o-g2)/(mg2-g2)))),md2==d2)e<=md2&&md2<=n&&(r=Math.min(r,(d2-n)/(n-e)));else if(o=n==e?e:((md2-d2)*n+(n-e)*d2)/(md2-d2+(n-e)),md2-d2+(n-e)==0){if(e==md2&&n==d2)return 0}else md2<=o&&o<=d2&&(r=Math.min(r,(o-d2)/(md2-d2)));if(mg2==g2)a<=mg2&&mg2<=s&&(r=Math.min(r,(g2-a)/(s-a)));else if(o=a==s?s:((mg2-g2)*a+(a-s)*g2)/(mg2-g2+(a-s)),mg2-g2+(a-s)==0){if(g2==a&&mg2==s)return 0}else g2<=o&&o<=mg2&&(r=Math.min(r,(o-g2)/(mg2-g2)));return md2==d2?a<=md2&&md2<=s&&(r=Math.min(r,(d2-a)/(s-a))):(o=a==s?s:((md2-d2)*a+(a-s)*d2)/(md2-d2+(a-s)),md2<o&&o<=d2&&(r=Math.min(r,(o-d2)/(md2-d2)))),r},this.gradeOfMembership=function(t,i){return i<t.bounds[0]?0:i<t.bounds[1]?(i-t.bounds[0])/(t.bounds[1]-t.bounds[0]):i<t.bounds[2]?1:i<t.bounds[3]?(t.bounds[3]-i)/(t.bounds[3]-t.bounds[2]):t.bounds[2]==t.bounds[3]?1:0},this.defuzzify=function(t,o){var e,n=[],a=[],s=[];if(Array.isArray(o[0].prototype))for(j=0;j<o[0].prototype.length;j++)n[j]=0,a[j]=0;else a[n[0]=0]=0;for(i=0;i<t.length;i++)if(e=o.findIndex(this.checkLabel,t[i]),Array.isArray(o[e].prototype))for(j=0;j<o[0].prototype.length;j++)n[j]=n[j]+t[i].value*o[e].prototype[j],a[j]=a[j]+t[i].value;else n[0]=n[0]+t[i].value*o[e].prototype,a[0]=a[0]+t[i].value;if(Array.isArray(o[0].prototype)){for(j=0;j<o[0].prototype.length;j++)s[j]=n[j]/a[j];return s}return s[0]=n[0]/a[0],s[0]},this.checkLabel=function(t){return t.label==this.label}}